
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>葱末COngMo</title>
  <meta name="author" content="xiaori.liu">

  
  <meta name="description" content="There have been tons of comparisons between Ruby and other languages (mostly Python) ranging from the technical to the epically titled. I&#8217;ve &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://congmo.github.com/blog/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="葱末COngMo" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">葱末COngMo</a></h1>
  
    <h2>与人玫瑰，手有余香.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:congmo.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/28/the-futures-pretty-cool/">The Future&#8217;s Pretty Cool (or Why I Love Ruby)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-28T00:00:00+08:00" pubdate data-updated="true">Apr 28<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There have been tons of comparisons between Ruby and other languages (mostly Python) ranging from the <a href="http://c2.com/cgi/wiki?PythonVsRuby">technical</a> to the <a href="http://blog.extracheese.org/2010/02/python-vs-ruby-a-battle-to-the-death.html">epically titled</a>. I&#8217;ve always felt that both languages are nice, but feel much more at home with the expressive, readable Ruby syntax. And don&#8217;t get me wrong, I love Ruby for all kinds of language reasons. Re-openable classes, blocks and the general meta-programming <span class="caps">DNA</span> of Ruby make it just wonderfully powerful and useful for me as a developer. However, when I think about it the language is really only half the story when it comes to why I love being a Ruby developer.</p>
<p style="float:right; margin:0 0 10px 15px;"><a href='http://xkcd.com/442/' title='I Love The Lisp Chainsaw'><img src='http://img.skitch.com/20100427-nwyu72qkhxhking8626aeixkys.png' alt="XKCD The Future's Pretty Cool"/></a></p>
<p>Whether it&#8217;s inherent in the makeup of the language and those to whom it appeals or the &#8220;buck the mainstream&#8221; attitude of Rails&#8217;s opinionated-ness, Rubyists tend to take to new things like fish to water. An outsider may look at the insane progression of testing frameworks and other different-ways-to-do-the-same-thing and think it&#8217;s a kind of madness, sickness, or chaos. Well, I suppose it is. However, living inside the Ruby hurricane has helped me to grow as a developer more than I could possibly have imagined in the few years I&#8217;ve been doing it full time. Thanks to Ruby, I was on board with these technologies months or even years before I feel I otherwise would have been (just a few examples):</p>
<ul>
	<li><strong>Test-Driven Development:</strong> Already a mainstay in the Ruby community when I joined it, <span class="caps">TDD</span> has seen some pretty rapid expansion into other languages and communities. I&#8217;m not saying Ruby was the first or only, but it was certainly an early and strong <span class="caps">TDD</span> community.</li>
	<li><strong>Distributed Version Control:</strong> <a href="http://github.com/">GitHub</a> is the future not only of project version control but of open-source collaboration. SourceForge by comparison seems like a lumbering dinosaur. Fork, fix, push.</li>
	<li><strong>NoSQL:</strong> I was playing with CouchDB about a year ago, not realizing that soon it would be a player in the biggest developer flamewar since Vim vs. Emacs.</li>
</ul>
<p>I&#8217;m not trying to say that X language doesn&#8217;t promote innovation or adoption of new ideas or Y has an inferior community. This isn&#8217;t a comparison post. I just know that when it comes to new technologies, most Rubyists I know are already jumping out of the plane while still trying to figure out how the parachute works. That sounds like an insult, but I think it&#8217;s amazing. We have a community of people so excited about technology that they literally can&#8217;t wait to build on it or for it, and share it with others. The huge proliferation of regional Ruby conferences speaks to this: we&#8217;re a group of people so intensely interested in learning about what&#8217;s new that we can&#8217;t manage holding just a few mainstream conferences each year.</p>
<p>For me, being a part of the Ruby community feels like getting a sneak peek at where software development is going six months to two years from now. That&#8217;s not to say it&#8217;s all rainbows and daisies&#8230;the constantly changing landscape requires a real passionate dedication to keep up or you&#8217;ll quickly fall behind, and not all technologies are meant to immediately be deployed to massive-scale production environments (restraint is a skill a good Rubyist must learn and exercise on a regular basis). But I love Ruby because I feel confident that I will be made aware of trends in software development long before I would otherwise be expected to understand them.</p>
<p>It&#8217;s fun to live in the future.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/23/facebook-is-the-private-beta-of-the-semantic-web/">Facebook Is the Private Beta of the Semantic Web</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-23T00:00:00+08:00" pubdate data-updated="true">Apr 23<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Facebook recently announced their intentions to become the center of the universe for online identity and social connections. While the new functionality of the Facebook Open Graph is exciting and represents a real glimpse into the interconnected semantic web, it has also sparked <a href="http://thefastertimes.com/mediaandtech/2010/04/22/my-facebook-problem-and-yours/">numerous</a> <a href="http://blog.jakerlevine.com/post/539731920/if-facebook-is-an-open-platform-then-the-web-is-a">concerns</a> about placing so much power into the hands of a single company. As it turns out, not everyone on earth is content with having their Facebook profile be the only representation of their identity on the web. To those sweating over the level of control and power this gives Facebook, I say:</p>
<p align='center'><img src='http://img.skitch.com/20100423-jepjp1x576hxfii15ixfxyuacr.png' alt="Don't Panic!"/></p>
<p>Yes, if Facebook perpetually controlled identity and semantic &#8220;Liking&#8221; that would be very bad for the web as a community. And it seems like it will be difficult to overcome the hurdle of that damn &#8220;Like&#8221; button on every page on the internet, right? I mean, sites aren&#8217;t going to want a <span class="caps">NASCAR</span> array of &#8220;Like&#8221; buttons cluttering up the place. How can anyone be expected to compete with Facebook&#8217;s 400 million user promise?</p>
<h3>Terraforming the Web</h3>
<p style='float: right; margin: 0 0 10px 15px'><img src='http://img.skitch.com/20100423-ba4c3fd8ifg7pwwh3w7c7cfbum.png' alt='Terraforming in Action!'/></p>
<p>We should really all be thanking Facebook for what they&#8217;re doing. They&#8217;re essentially the first colonization spaceship sent out to the world wide web, a rough-and-tumble wild west crew that gets to make their own rules because they&#8217;re doing the pioneering. And while their approach may smack of self-interest, you have to realize it could have been so much worse.</p>
<p>The acquisition of FriendFeed seems to be the best thing that could possibly have happened to Facebook, because rather than the openness of FriendFeed being subsumed by the closed past of Facebook, the FriendFeed team seems to have done the impossible: they&#8217;ve convinced Facebook to participate in the broader conversation about open standards (even if tentatively).</p>
<p>The result of Facebook&#8217;s Open Graph push will basically terraform the web, reshaping it into something new where semantic applications can thrive. Of course Facebook is doing this all for their own benefit&#8230;why shouldn&#8217;t they? But they&#8217;re also doing it in such a way that they simply will not have control of it forever. So how can this shake out for the best? How can an open protocol with a proprietary &#8220;Like&#8221; button become the open, semantic web that many dream of? Simple. Browsers.</p>
<h3>Firefox and Chrome are the Key</h3>
<p>Ultimately the interaction with the semantic web doesn&#8217;t belong on the website to begin with. That&#8217;s Web 2.0 thinking. What we&#8217;re going to see in the next months and years is a move of semantic activity and identity being handled in the browser, either explicitly by the vendor or through extensions on their platform. <a href="http://www.azarask.in/blog/post/identity-in-the-browser-firefox/">Mozilla is already experimenting with this</a>, and I would bet Google has some ideas of their own along the same lines.</p>
<p style='float: left; margin: 0 15px 10px;'><img src='http://img.skitch.com/20100423-ggpf2ucd5r8hx9mhnqbpxjir3a.png' alt='Browser Icons'/></p>
<p>So while Facebook may get to own the &#8220;Like&#8221; button on the page, once every browser comes with a &#8220;Like&#8221; button that connects to any number of services according to an open protocol, once I can log into a site using identity stored in my browser and skip the Facebook authorization dance, the semantic web will be realized in full. And the great thing is, everyone will have all of the data they need to build such services thanks to the aggressive partnerships pursued by Facebook.</p>
<p>In essence, <strong>everything</strong> that Facebook announced at F8 ultimately belongs in the browser, not through a single connection to a proprietary service. And the great thing is that not only is that the better solution for proponents of the open web, but it&#8217;s also <strong>even easier than Facebook</strong> for users of the browsers that eventually gain these features. Facebook has always won the war for identity based on convenience, but nothing is more convenient than the tools built in to my browser of choice.</p>
<p>So thanks, Facebook, for launching the private beta of the semantic web. I can&#8217;t wait to see what happens when it goes public.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/22/oauth2-gem/">Announcing the OAuth2 Gem</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-22T00:00:00+08:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While I&#8217;d been tracking with great interest the progress of OAuth 2.0, Facebook lit off the powderkeg yesterday by announcing that their entire <span class="caps">API</span> was moving to the protocol (as well as to RESTful <span class="caps">JSON</span>). As a developer who had been constantly confounded by the relentlessly hostile environment that Facebook seemed to present to developers, yesterday was a sudden and welcome about-face. The acquisition of <a href="http://friendfeed.com/">FriendFeed</a>, it seems, gave Facebook the talent they needed to do it right this time.</p>
<p>But anyway, on to the news! We have just released a gem for OAuth 2.0 to work with the new Facebook <span class="caps">API</span>. You can get it right now:</p>
<pre>gem install oauth2</pre>
<p>We wanted to get this into the hands of developers <span class="caps">ASAP</span> so for now the functionality is pretty much limited to the &#8220;web server&#8221; type of authentication (the protocol includes many different strategies, all of which will be implemented on the gem over time) and has been tested to work with <a href="http://developers.facebook.com/docs/api#authorization">Facebook&#8217;s new <span class="caps">API</span></a>.</p>
<p>So how do you use it? Here is an example Sinatra application containing all of the code necessary to authenticate and then perform requests against the Facebook <span class="caps">API</span>.</p>
<pre name='code' class='ruby'>require 'rubygems'
require 'sinatra'
require 'oauth2'
require 'json'

def client
  OAuth2::Client.new('api_key', 'api_secret', :site =&gt; 'https://graph.facebook.com')
end

get '/auth/facebook' do
  redirect client.web_server.authorize_url(
    :redirect_uri =&gt; redirect_uri, 
    :scope =&gt; 'email,offline_access'
  )
end

get '/auth/facebook/callback' do
  access_token = client.web_server.get_access_token(params[:code], :redirect_uri =&gt; redirect_uri)
  user = JSON.parse(access_token.get('/me'))

  user.inspect
end

def redirect_uri
  uri = URI.parse(request.url)
  uri.path = '/auth/facebook/callback'
  uri.query = nil
  uri.to_s
end</pre>
<p>So now you&#8217;re ready to get started with the new Facebook <span class="caps">API</span>! This is still an early release, but I&#8217;ll be working on it a lot in the coming months, partially as preparation for my <a href="http://en.oreilly.com/rails2010/public/schedule/detail/14071">talk at RailsConf</a> in which I&#8217;ll be delving into the OAuth 2.0 specification and what it means for Rails developers in-depth. The code is, of course, <a href="http://github.com/intridea/oauth2">available on GitHub</a> where you can report any problems you run into. Enjoy!</p>
<p><strong>Update:</strong> Those who aren&#8217;t terribly familiar with the protocol may wonder why OAuth 2.0 isn&#8217;t just rolled into support of the OAuth gem (or why I didn&#8217;t fork it and do it that way). Honestly, I would have liked to, but OAuth 2.0 is an almost entirely different beast than 1.0a and they share so little functionality that it would basically be two projects living under the same gem name. So that&#8217;s why!</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/19/ruby-quick-tip-instant-utility-modules/">Ruby Quick Tip: Instant Utility Modules</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-19T00:00:00+08:00" pubdate data-updated="true">Apr 19<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sometimes you want to write a batch of utility methods that can be accessed from a module for example <code>Utility.parse_something(string)</code> or any number of useful little tools for your application. Here&#8217;s a very clean-looking way to achieve it:</p>
<pre name='code' class='ruby'>module Utilities
  extend self

  def parse_something(string)
    # do stuff here
  end

  def other_utility_method(number, string)
    # do some more stuff
  end
end</pre>
<p>By placing <code>"extend self"</code> at the top of the module, you are telling it to include all of the methods defined on your module as class methods on&#8230;your module. Which means that you can now access them like other class methods! While there are other ways to do this, I think this is a very semantically clean way that gets it done quite nicely.</p>
<p><strong>Update:</strong> And this is exactly why I post these Quick Tips, because sometimes there&#8217;s another solution that I hadn&#8217;t heard of! Using Ruby&#8217;s <code>module_function</code> you can achieve the same effect:</p>
<pre name='code' class='ruby'>module Utilities
  module_function
  
  def parse_something(string)
    # do stuff here
  end

  def other_utility_method(number, string)
    # do some more stuff
  end
end</pre>
<p>The <code>module_function</code> method either takes multiple symbols as arguments for the methods to turn into module methods or, if invoked without arguments, will cause all subsequent methods to be defined as module functions. You can <a href="http://ruby-doc.org/core/classes/Module.html#M001642">read the Ruby documentation about it here</a>. Ultimately I&#8217;m not sure which I&#8217;d go with, as <code>module_function</code> is pretty esoteric (I&#8217;ve never come across it in code that I&#8217;ve read), but so is <code>extend self</code>. It&#8217;s your call, developers!</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/12/toggle-css3-bookmarklet/">Toggle CSS3 Bookmarklet</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-12T00:00:00+08:00" pubdate data-updated="true">Apr 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you&#8217;ve begun to use CSS3 experimental features in your sites lately such as <code>box-shadow</code>, <code>border-radius</code> or <code>text-shadow</code>, you know how much pain it can take away from the design process. Unfortunately, lots of people are still using Internet Explorer and can&#8217;t see all these pretty additions you&#8217;ve added.</p>
<p>I thought it would be useful to have a simple way to run a sanity check on my design to make sure it wasn&#8217;t going to look awful or unreadable once all of the CSS3 goodies were taken away. With that in mind, I created a bookmarklet that will toggle the display of all of that modern goodness.</p>
<p>Just drag this link: <a href="javascript:void(function(){if(document.getElementById('uncss3')){var uncss=document.getElementById('uncss3');uncss.parentNode.removeChild(uncss);}else{var css='* { -moz-border-radius: 0 !important; -webkit-border-radius: 0 !important; border-radius: 0 !important; -webkit-box-shadow: none !important; -moz-box-shadow: none !important; box-shadow: none !important; -moz-border-image: none !important; -webkit-border-image: none !important; border-image: none !important; text-shadow: none !important; -webkit-background-origin: border-box !important; -moz-background-origin: border-box !important; background-origin: border-box !important; -moz-background-clip: border-box !important; -webkit-background-clip: border-box !important; background-clip: border-box !important; }';var uncss=document.createElement('style');uncss.setAttribute('type','text/css');uncss.setAttribute('id','uncss3');uncss.innerText=css;document.getElementsByTagName('head')[0].appendChild(uncss);}})();">Toggle CSS3</a> into your bookmark toolbar. Then, by clicking it, you can turn off (and back on) the most common CSS3 improvements. Once installed, if you visit a page such as <a href="http://www.css3.info/preview/box-shadow/">CSS3.info</a> and click the bookmarklet, you should see the CSS3 effects toggle off.</p>
<p>Note that this is a simple, none-too-bright bookmarklet and only removes the obvious traces of CSS3. It doesn&#8217;t inspect your <span class="caps">CSS</span> for non-supported color values (like <span class="caps">RGBA</span>) or deal with many of the more advanced features of CSS3. In fact, all it does is eradicate these styles:</p>
<ul>
	<li><code>border-radius</code></li>
	<li><code>box-shadow</code></li>
	<li><code>text-shadow</code></li>
	<li><code>border-image</code></li>
	<li><code>background-origin</code></li>
	<li><code>background-clip</code></li>
</ul>
<p>However, it&#8217;s still a useful tool if you&#8217;re designing for the future with an eye for the past. Enjoy!</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/29/ruby-quicktip-regular-expressions-in-case-statements/">Ruby Quick Tip: Regular Expressions in Case Statements</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-29T00:00:00+08:00" pubdate data-updated="true">Mar 29<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Did you know that you can use regular expressions in <code>case</code> statements in Ruby to check for a match? For instance, if I&#8217;m implementing some <code>method_missing</code> functionality and I want to check for bang or question methods, I might be tempted to do something like this:</p>
<div>
<pre><code class='ruby'>def method_missing(name, *args)
name = name.to_s
if name.match(/!$/)
puts &quot;Bang Method!&quot;
elsif name.match(/\?$/)
puts &quot;Query Method?&quot;
else
super
end
<p>end</code></pre></p>
</div>
<p>But it&#8217;d be much cleaner if instead it looked like this:</p>
<div>
<pre><code class='ruby'>def method_missing(name, *args)
case name.to_s
when /!$/
puts &quot;Bang Method!&quot;
when /\?$/
puts &quot;Query Method?&quot;
else
super
end
<p>end</code></pre></p>
</div>
<p>This is great, but now what if we want to call out a method for bang and question methods? Thankfully Ruby has us covered there as well:</p>
<div>
<pre><code class='ruby'>def method_missing(name, *args)
case name.to_s
when /^(.*)!$/
bang_method($1)
when /^(.*)\?$/
question_method($1)
else
super
end
<p>end</code></pre></p>
</div>
<p>By using the <code>$1</code> global variable we can access the last regular expression match performed by ruby. This is just one of those little details that makes working with Ruby such a joy.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/05/hashie-gains-a-chainable-hash/">Hashie Gains a Chainable Hash</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-05T00:00:00+08:00" pubdate data-updated="true">Mar 5<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://intridea.com/2009/11/12/hashie-the-hash-toolkit">Hashie</a>, Intridea&#8217;s Hash Toolkit, is today with version 0.2.0 gaining a new member: the Clash.</p>
<p>A Clash is a &#8220;Chainable Lazy Hash&#8221; that allows you to construct a hash using method syntax. It is meant to be used in a similar way to the way that Rails 2.x&#8217;s <code>named_scope</code> or Arel&#8217;s query building work. Let&#8217;s start with an example:</p>
<div>
<pre><code class='ruby'>require 'hashie/clash'
<p>c = Hashie::Clash.new<br />
c.where(:abc =&gt; &#8216;def&#8217;).order(:created_at)</p>
<p>c == {:where =&gt; {:abc =&gt; &#8217;def&#8217;}, :order =&gt; :created_at}</code></pre></p>
</div>
<p>Pretty neat, right? But you can go beyond that. Clash also allows you to use bang method notation to create, dive into, and return from sub-hashes. Let me show you what I mean:</p>
<div>
<pre><code class='ruby'>c = Hashie::Clash.new
<p>c.where<img src=".abc(&#39;def&#39;).ghi(123)._end" alt="" />.order(:created_at)</p>
<p>c == {:where =&gt; {:abc =&gt; &#8216;def&#8217;, :ghi =&gt; 123}, :order =&gt; :created_at}</code></pre></p>
</div>
<p>By using a bang method, you automatically create a subhash that is then the subject of the chain, allowing you to create more keys on that subhash. Then, if you want to jump back up to the top-level hash, you simply call the <code>_end!</code> method to return up one level in the stack (thanks to jQuery for that particular inspiration).</p>
<p>While Clash is a very simple tool, we hope that it could eventually make its way into some of the new ORMs that are cropping up around NoSQL systems (such as <a href="http://github.com/jnunemaker/mongomapper">MongoMapper</a>) to provide the same kind of effortless chaining that has made ActiveRecord so easy to work with.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/02/12/redfinger-a-ruby-webfinger-gem/">Redfinger: A Ruby WebFinger Gem</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-12T00:00:00+08:00" pubdate data-updated="true">Feb 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Just yesterday, Google <a href="http://www.readwriteweb.com/archives/google_enables_webfinger_for_google_profiles_email_as_identity.php">turned on webfinger for all GMail accounts</a>. Today, I&#8217;m releasing a RubyGem to help you use the new protocol!</p>
<h3>What&#8217;s a WebFinger?</h3>
<p><a href="http://code.google.com/p/webfinger/">WebFinger</a> is a new protocol for extracting public information about a person via their e-mail address. It is meant to complement systems such as OpenID as well as give a simple way to get basic information about a user without having to ask them for it.</p>
<p>E-Mail providers can implement WebFinger by creating a special <span class="caps">URL</span> (specifically at <code>/.well-known/host-meta</code>) that is an <span class="caps">XRD</span> <span class="caps">XML</span> document telling the requester a <span class="caps">URL</span> at which they can find out more about e-mail addresses on their domain. Google&#8217;s, for example, is <code>http://www.google.com/s2/webfinger/?q={uri}</code>. When the WebFinger endpoint is requested with an e-mail address in place of <code>{uri}</code>, Google looks up information about that e-mail&#8217;s public profile and provides it in a standardized <span class="caps">XRD</span> <span class="caps">XML</span> format.</p>
<p>So why WebFinger when OpenID already exists? Users are used to associating their e-mail address with their identity. It&#8217;s natural since an e-mail address is (usually) for a specific person. By putting a protocol in place to find out more about an e-mail address without requiring additional input from the user, a host of options become available.</p>
<p>For instance, if I&#8217;m an application looking to authenticate using OpenID, I can ask a user for their e-mail address instead of their OpenID <span class="caps">URL</span> (something that will confuse mainstream users to no end). Or, if I want to automatcially fill in basic profile information, I can check to see if a parseable profile page is available in a format such as hCard.</p>
<h3>Enter Redfinger</h3>
<p>Redfinger is a library built to easily consume the WebFinger protocol. Installing it is simple:</p>
<pre>gem install redfinger</pre>
<p>Using it is just as simple:</p>
<div>
<pre><code class='ruby'>require 'rubygems'
<p>require &#8216;redfinger&#8217;</p>
<p>finger = Redfinger.finger(&#8216;youraccount@gmail.com&#8217;)<br />
finger.open_id.first.to_s # =&gt; &quot;http://www.google.com/profiles/youraccount&quot;</code></pre></p>
</div>
<p>Redfinger will query the host of the e-mail domain specified, and, if the Webfinger protocol is supported, retrieve information about that e-mail address including such links as OpenID Provider, hCard <span class="caps">URL</span>, and more.</p>
<p>How can you use this today? Well, if you&#8217;re an OpenID consumer you can use the above code to try to &#8220;intelligently find&#8221; an OpenID endpoint from an e-mail address. Of course, it will just about only work with Google at the moment (this is an alpha protocol, after all). Or, you could install the <code>mofo</code> gem (a gem for parsing microformats for web pages) and do some neat things with microformats:</p>
<div>
<pre><code class='ruby'>require 'rubygems'
<p>require &#8216;mofo&#8217;<br />
require &#8216;redfinger&#8217;</p>
<p>finger = Redfinger.finger(&#8216;account@gmai.com&#8217;)<br />
card = hCard.find(finger.hcard.first.to_s)<br />
card.fn # =&gt; &quot;That GMail user&#8217;s full name&quot;<br />
card.title # =&gt; &quot;The title he/she entered on Google Profile&quot;</code></pre></p>
</div>
<p>Here Redfinger determines a <span class="caps">URL</span> that will have hCard information about the e-mail address specified, and the Mofo gem goes out and fetches that address, parsing out the information.</p>
<p>WebFinger is still brand new (Google calls it &#8220;alpha&#8221;) but it shows some promise for being a great way to make the open web more seamless for users. As always, <a href="http://github.com/intridea/redfinger">the Redfinger source code is available on GitHub</a> and <a href="http://rdoc.info/projects/intridea/redfinger">RDoc Documentation</a> is available. Check it out!</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/21/simple-mustache-json-serialization/">Simple Mustache JSON Serialization</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-21T00:00:00+08:00" pubdate data-updated="true">Jan 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you&#8217;ve taken a look at <a href="http://github.com/defunkt/mustache">Mustache</a>, the &#8220;stupid in a good way&#8221; templating engine, you might know that there are also Javascript Mustache renderers such as <a href="http://github.com/janl/mustache.js">Mustache.js</a>. Today I&#8217;ve released a small library called <a href="http://github.com/intridea/mustache_json">mustache_json</a> that allows you to compile your Mustache view objects into <span class="caps">JSON</span>, allowing them to be interpreted by Javascript Mustache rendering engines.</p>
<p>What this means for your project is that you will finally have a identical client-side and server-side rendering interface, opening wide the opportunities for pushing more of the rendering work onto the client-side, a boon for many real-time and heavy-interaction applications.</p>
<p>To install <code>mustache_json</code>, just get the gem from Gemcutter:</p>
<pre><code>gem install mustache_json</code></pre>
<p>To use it, simply <code>require 'mustache_json'</code> and all of your Mustache objects will automatically be given a <code>#to_json</code> method. For instance:</p>
<div>
<pre><code class='ruby'>require 'mustache_json'
<p>class Person &lt; Mustache<br />
  def initialize(first_name, last_name)<br />
    context[:first_name], context[:last_name] = first_name, last_name<br />
  end</p>
def initials
&quot;#{context[:first_name][0..0]}.#{context[:last_name][0..0]}.&quot;
end

def listing
&quot;#{context[:last_name]}, #{context[:first_name]}&quot;
end
<p>end</p>
<p>bob = Person.new(&#8216;Bob&#8217;, &#8216;Bobson&#8217;)<br />
bob.to_json</code></pre></p>
</div>
<p>This will render into a <span class="caps">JSON</span> object that looks like this:</p>
<div>
<pre><code class='javascript'>{&amp;quot;last_name&amp;quot;:&amp;quot;Bobson&amp;quot;,&amp;quot;initials&amp;quot;:&amp;quot;B.B.&amp;quot;,&amp;quot;listing&amp;quot;:&amp;quot;Bobson, Bob&amp;quot;,&amp;quot;first_name&amp;quot;:&amp;quot;Bob&amp;quot;}</code></pre>
</div>
<p>Mustache <span class="caps">JSON</span> gives you access to all of the public instance methods you declare in your Mustache as well as any context you have set. It is essentially a fully compiled version of the Mustache view, providing everything another renderer needs to create the actual markup. The <span class="caps">JSON</span> back-end for this library is swappable, meaning you can use the <span class="caps">JSON</span> gem, <span class="caps">JSON</span> pure, ActiveSupport, or Yajl by default (and any other class with an <code>encode</code> method if you&#8217;ve got a different library).</p>
<p><a href="http://rdoc.info/projects/intridea/mustache_json">Documentation is available on RDoc.info</a> and the <a href="http://github.com/intridea/mustache_json">source is available on GitHub</a>. Stay tuned for posts in the future about utilizing this library to actually perform identical rendering in Ruby and Javascript.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/11/18/compiling-mustache-views-for-mustache-js/">Compiling Mustache Views for Mustache.js</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-18T00:00:00+08:00" pubdate data-updated="true">Nov 18<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been investigating the usage of <a href="http://github.com/defunkt/mustache">Mustache</a>, the dead-simple templating language with the funny name, and one very enticing aspect of Mustache is that it&#8217;s so simple it can easily be ported across languages. <a href="http://github.com/janl/mustache.js">Mustache.js</a> is a Javascript implementation of Mustache that works based on a simple <span class="caps">JSON</span> hash and a string template. Wouldn&#8217;t it be awesome if we could use the same Mustache template on the server side and in Javscript without having to construct two sets of logic? Yes it would, and here&#8217;s how.</p>
<h3>Creating a Serializable Mustache</h3>
<p>Mustache works by calling methods from the template on the Mustache view object. There are no arguments, no filters, just plain old Ruby methods. Mustache.js works by reading values from a Javascript object or evaluating functions on<br />
that object. So, if we want to use the same logic to power both our Ruby-built Mustaches and our Javascript-built Mustaches, all we need to do is convert that logic to <span class="caps">JSON</span>!</p>
<p>Now, you could write a <code>#to_json</code> method for each of your Mustache views, but where&#8217;s the DRYness in that? Instead let&#8217;s create a Serializable Mustache that automatically catalogs the methods that need to be serialized to <span class="caps">JSON</span>:</p>
<div>
<pre><code class='ruby'>module Mustache::Serializable
def self.included(base)
base.extend ClassMethods
end

module ClassMethods
def serializable_methods
public_instance_methods(false)
end
end
def serializable_hash
hash = self.class.serializable_methods.inject({}) do |result, method|
<ol>
	<li>Symbolize the method to work better with the Mustache Context.<br />
      result[method.to_sym] = self.send(method)<br />
      result<br />
    end</li>
</ol>
hash.merge!(self.context)
end
def to_json
serializable_hash.to_json
end
<p>end</code></pre></p>
</div>
<p>That was easy enough! What we&#8217;re doing is compiling a list of methods that we want to serialize by saying &#8216;any public method that is declared in <strong>this specific Mustache class</strong> should be serialized&#8217;, constructing a hash from those methods, merging in the Mustache&#8217;s context, and providing a <span class="caps">JSON</span> representation of that hash.</p>
<h3>Rendering in Ruby</h3>
<p>Now that you have a simple way to serialize to <span class="caps">JSON</span>, we need to actually be able to render this Mustache in it&#8217;s server-side native form: Ruby. Here let&#8217;s say we&#8217;re working on a Sinatra application since it has probably the simplest setup. We&#8217;re not going to use the built-in Sinatra support from Mustache because it will be clearer in the code if we don&#8217;t. Here&#8217;s the entire application (make sure you somehow include the serializable code from above):</p>
<div>
<pre><code class='ruby'>require 'rubygems'
<p>require &#8216;sinatra&#8217;<br />
require &#8216;mustache&#8217;</p>
<p>class Person &lt; Mustache<br />
  include Mustache::Serializable</p>
def initialize(first_name, last_name)
@first_name = first_name
@last_name = last_name
end

def formal_name
&quot;#{@last_name}, #{@first_name}&quot;
end

def initials
&quot;#{@first_name[0..0]}.#{@last_name[0..0]}&quot;
end

template = &lt;&lt;-<span class="caps">HTML</span>
&lt;dl&gt;
&lt;dt&gt;Formal Name:&lt;/dt&gt; &lt;dd&gt;&lt;/dd&gt;
&lt;dt&gt;Initials:&lt;/dt&gt; &lt;dd&gt;&lt;/dd&gt;
&lt;/dl&gt;
<span class="caps">HTML</span>
<p>end</p>
<p>get &#8216;/person/:last_name/:first_name.:format&#8217; do<br />
  @mustache = Person.new(params[:first_name], params[:last_name])<br />
  @mustache.to_html<br />
end</code></pre></p>
</div>
<h3>Rendering in Javascript</h3></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/02/01/test-chinese/">Guest Post on RubyLearning: 中文Building DSLs with yield and instance_eval</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/17/2/">MultiJSON: The Swappable JSON Handler</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/16/testtesttest/">teesesest</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/11/30/rubylearning-guest-post/">Guest Post on RubyLearning: Building DSLs with yield and instance_eval</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/10/03/omniauth-flexible-authentication-for-rack/">OmniAuth: Flexible, Unassuming Multi-Provider Authentication for Rack</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - xiaori.liu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
