
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Announcing the OAuth2 Gem - 葱末COngMo</title>
  <meta name="author" content="xiaori.liu">

  
  <meta name="description" content="While I&#8217;d been tracking with great interest the progress of OAuth 2.0, Facebook lit off the powderkeg yesterday by announcing that their entire &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://congmo.github.com/blog/2010/04/22/oauth2-gem">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="葱末COngMo" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">葱末COngMo</a></h1>
  
    <h2>与人玫瑰，手有余香.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:congmo.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Announcing the OAuth2 Gem</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-22T00:00:00+08:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>While I&#8217;d been tracking with great interest the progress of OAuth 2.0, Facebook lit off the powderkeg yesterday by announcing that their entire <span class="caps">API</span> was moving to the protocol (as well as to RESTful <span class="caps">JSON</span>). As a developer who had been constantly confounded by the relentlessly hostile environment that Facebook seemed to present to developers, yesterday was a sudden and welcome about-face. The acquisition of <a href="http://friendfeed.com/">FriendFeed</a>, it seems, gave Facebook the talent they needed to do it right this time.</p>
<p>But anyway, on to the news! We have just released a gem for OAuth 2.0 to work with the new Facebook <span class="caps">API</span>. You can get it right now:</p>
<pre>gem install oauth2</pre>
<p>We wanted to get this into the hands of developers <span class="caps">ASAP</span> so for now the functionality is pretty much limited to the &#8220;web server&#8221; type of authentication (the protocol includes many different strategies, all of which will be implemented on the gem over time) and has been tested to work with <a href="http://developers.facebook.com/docs/api#authorization">Facebook&#8217;s new <span class="caps">API</span></a>.</p>
<p>So how do you use it? Here is an example Sinatra application containing all of the code necessary to authenticate and then perform requests against the Facebook <span class="caps">API</span>.</p>
<pre name='code' class='ruby'>require 'rubygems'
require 'sinatra'
require 'oauth2'
require 'json'

def client
  OAuth2::Client.new('api_key', 'api_secret', :site =&gt; 'https://graph.facebook.com')
end

get '/auth/facebook' do
  redirect client.web_server.authorize_url(
    :redirect_uri =&gt; redirect_uri, 
    :scope =&gt; 'email,offline_access'
  )
end

get '/auth/facebook/callback' do
  access_token = client.web_server.get_access_token(params[:code], :redirect_uri =&gt; redirect_uri)
  user = JSON.parse(access_token.get('/me'))

  user.inspect
end

def redirect_uri
  uri = URI.parse(request.url)
  uri.path = '/auth/facebook/callback'
  uri.query = nil
  uri.to_s
end</pre>
<p>So now you&#8217;re ready to get started with the new Facebook <span class="caps">API</span>! This is still an early release, but I&#8217;ll be working on it a lot in the coming months, partially as preparation for my <a href="http://en.oreilly.com/rails2010/public/schedule/detail/14071">talk at RailsConf</a> in which I&#8217;ll be delving into the OAuth 2.0 specification and what it means for Rails developers in-depth. The code is, of course, <a href="http://github.com/intridea/oauth2">available on GitHub</a> where you can report any problems you run into. Enjoy!</p>
<p><strong>Update:</strong> Those who aren&#8217;t terribly familiar with the protocol may wonder why OAuth 2.0 isn&#8217;t just rolled into support of the OAuth gem (or why I didn&#8217;t fork it and do it that way). Honestly, I would have liked to, but OAuth 2.0 is an almost entirely different beast than 1.0a and they share so little functionality that it would basically be two projects living under the same gem name. So that&#8217;s why!</p></div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">xiaori.liu</span></span>

      








  


<time datetime="2010-04-22T00:00:00+08:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2010</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://congmo.github.com/blog/2010/04/22/oauth2-gem/" data-via="" data-counturl="http://congmo.github.com/blog/2010/04/22/oauth2-gem/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/04/19/ruby-quick-tip-instant-utility-modules/" title="Previous Post: Ruby Quick Tip: Instant Utility Modules">&laquo; Ruby Quick Tip: Instant Utility Modules</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/04/23/facebook-is-the-private-beta-of-the-semantic-web/" title="next Post: Facebook is the Private Beta of the Semantic Web">Facebook is the Private Beta of the Semantic Web &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/02/01/test-chinese/">Guest Post on RubyLearning: 中文Building DSLs with yield and instance_eval</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/17/2/">MultiJSON: The Swappable JSON Handler</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/16/testtesttest/">teesesest</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/11/30/rubylearning-guest-post/">Guest Post on RubyLearning: Building DSLs with yield and instance_eval</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/10/03/omniauth-flexible-authentication-for-rack/">OmniAuth: Flexible, Unassuming Multi-Provider Authentication for Rack</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - xiaori.liu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
